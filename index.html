<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-right: 12px;
        }


        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #666;
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .nav-item.active {
            background: #e3f2fd;
            color: #1976d2;
            border-left-color: #1976d2;
        }

        .nav-item-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-item-badge {
            background: #ff4757;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
            background: #f8f9fa;
        }

        .top-bar {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-bar-message {
            font-weight: 500;
        }


        .top-bar-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .icon-button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #666;
        }


        /* Content Sections */
        .content-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .section-subtitle {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .metric-title {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .metric-change {
            display: inline-flex;
            align-items: center;
            font-size: 0.85rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }

        .metric-change.positive {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .metric-change.negative {
            background: #ffebee;
            color: #c62828;
        }

        .metric-change.neutral {
            background: #fff3e0;
            color: #ef6c00;
        }

        /* NFT Grid */
        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .nft-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .nft-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .nft-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
        }

        .nft-info {
            padding: 15px;
        }

        .nft-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .nft-price {
            color: #1976d2;
            font-weight: 600;
        }

        /* News Cards */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 10px;
        }

        .news-card {
            display: flex;
            gap: 10px;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .news-card:hover {
            background: #f8f9fa;
        }


        .news-content h3 {
            font-size: 1rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .news-content p {
            color: #666;
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 5px;
        }

        .news-meta {
            font-size: 0.75rem;
            color: #999;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            opacity: 0.6;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Dark Theme Styles */
        body.dark-theme {
            background: #121212;
            color: #e0e0e0;
        }

        body.dark-theme .sidebar {
            background: #1e1e1e;
            border-right: 1px solid #333;
        }

        body.dark-theme .sidebar-header {
            border-bottom: 1px solid #333;
        }

        body.dark-theme .user-info {
            border-bottom: 1px solid #333;
        }

        body.dark-theme .nav-item:hover {
            background: #2a2a2a;
            color: #e0e0e0;
        }

        body.dark-theme .nav-item.active {
            background: #1a237e;
            color: #e3f2fd;
        }

        body.dark-theme .main-content {
            background: #121212;
        }

        body.dark-theme .top-bar,
        body.dark-theme .content-section,
        body.dark-theme .metric-card,
        body.dark-theme .nft-card,
        body.dark-theme .news-card {
            background: #1e1e1e;
            border-color: #333;
        }

        body.dark-theme .news-card:hover {
            background: #2a2a2a;
        }



        body.dark-theme .section-title {
            color: #e0e0e0;
        }

        body.dark-theme .metric-value {
            color: #e0e0e0;
        }

        /* Health Indicator Styles */
        .health-indicator {
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            text-align: center;
        }

        .health-indicator.healthy {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .health-indicator.warning {
            background: #fff3e0;
            color: #ef6c00;
        }

        .health-indicator.danger {
            background: #ffebee;
            color: #c62828;
        }

        body.dark-theme .health-indicator.healthy {
            background: rgba(46, 125, 50, 0.3);
            color: #81c784;
        }

        body.dark-theme .health-indicator.warning {
            background: rgba(239, 108, 0, 0.3);
            color: #ffb74d;
        }

        body.dark-theme .health-indicator.danger {
            background: rgba(198, 40, 40, 0.3);
            color: #ef5350;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">üåç Dashboard</div>
            <p style="color: #666; font-size: 0.8rem;">Comprehensive Analytics</p>
        </div>

        <!--
        <div class="user-info">
            <div class="user-avatar">AH</div>
        </div>
        -->

        <nav class="nav-menu">
            <a href="#" class="nav-item active" data-section="economy">
                <div class="nav-item-icon">üìä</div>
                Economy
            </a>
            <a href="#" class="nav-item" data-section="climate">
                <div class="nav-item-icon">üå°Ô∏è</div>
                Climate
            </a>
            <a href="#" class="nav-item" data-section="news">
                <div class="nav-item-icon">üì∞</div>
                News
            </a>
            <a href="#" class="nav-item" data-section="digital-assets">
                <div class="nav-item-icon">üíé</div>
                Digital Assets
            </a>
            
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Bar -->
        <div class="top-bar">
            <div id="greeting" class="top-bar-message"></div>
            <div class="top-bar-actions">
                <button id="theme-toggle" class="icon-button">üåô</button>
                <div class="user-avatar" style="width: 32px; height: 32px;">AH</div>
            </div>
        </div>

        <!-- Economy Section -->
        <div class="content-section active" id="economy">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Ray Dalio's Economic Dashboard</h2>
                    <p class="section-subtitle">Key indicators for economic stability and crisis prediction</p>
                </div>
                <div id="lastUpdated" style="color: #666; font-size: 0.8rem;">Loading...</div>
            </div>

            <div style="margin-bottom: 20px; padding: 15px; border-radius: 8px; background: #f8f9fa; border-left: 4px solid #1976d2;">
                <h4 style="margin-bottom: 10px; color: #2c3e50;">üí° Ray Dalio's Economic Health Guide</h4>
                <div style="display: flex; gap: 20px; font-size: 0.85rem;">
                    <span style="color: #2e7d32;">üü¢ Healthy: Economy in good shape</span>
                    <span style="color: #ef6c00;">üü° Warning: Monitor closely</span>
                    <span style="color: #c62828;">üî¥ Danger: Crisis risk elevated</span>
                </div>
            </div>

            <!-- Credit Growth & Debt Levels -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Credit Growth &amp; Debt Levels</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Tracks credit expansion and overall debt burden to gauge financial stability.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Debt-to-GDP Ratio</div>
                        <div class="metric-value" id="debt-value">Loading...</div>
                        <div class="metric-change" id="debt-change">--</div>
                        <div class="health-indicator" id="debt-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Private Credit Growth</div>
                        <div class="metric-value" id="creditgrowth-value">Loading...</div>
                        <div class="metric-change" id="creditgrowth-change">--</div>
                        <div class="health-indicator" id="creditgrowth-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Debt Service Ratio</div>
                        <div class="metric-value" id="debtservice-value">Loading...</div>
                        <div class="metric-change" id="debtservice-change">--</div>
                        <div class="health-indicator" id="debtservice-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Interest Rates & Yield Curves -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Interest Rates &amp; Yield Curves</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Signals monetary policy stance and expectations for future growth.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Short-Term Rate</div>
                        <div class="metric-value" id="shortrate-value">Loading...</div>
                        <div class="metric-change" id="shortrate-change">--</div>
                        <div class="health-indicator" id="shortrate-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Long-Term Yield</div>
                        <div class="metric-value" id="longrate-value">Loading...</div>
                        <div class="metric-change" id="longrate-change">--</div>
                        <div class="health-indicator" id="longrate-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Yield Curve Spread</div>
                        <div class="metric-value" id="yieldcurve-value">Loading...</div>
                        <div class="metric-change" id="yieldcurve-change">--</div>
                        <div class="health-indicator" id="yieldcurve-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">30-Year Mortgage Rate</div>
                        <div class="metric-value" id="mortgage-value">Loading...</div>
                        <div class="metric-change" id="mortgage-change">--</div>
                        <div class="health-indicator" id="mortgage-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Money Supply & Liquidity -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Money Supply &amp; Liquidity</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Measures broad liquidity conditions via money supply and central bank actions.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">M2 Money Growth</div>
                        <div class="metric-value" id="m2growth-value">Loading...</div>
                        <div class="metric-change" id="m2growth-change">--</div>
                        <div class="health-indicator" id="m2growth-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Central Bank Balance</div>
                        <div class="metric-value" id="balancesheet-value">Loading...</div>
                        <div class="metric-change" id="balancesheet-change">--</div>
                        <div class="health-indicator" id="balancesheet-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Inflation & Inflation Expectations -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Inflation &amp; Inflation Expectations</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Current price pressures and future expectations guide policy responses.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Inflation Rate (YoY)</div>
                        <div class="metric-value" id="inflation-value">Loading...</div>
                        <div class="metric-change" id="inflation-change">--</div>
                        <div class="health-indicator" id="inflation-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Inflation Expectations</div>
                        <div class="metric-value" id="inflationexpect-value">Loading...</div>
                        <div class="metric-change" id="inflationexpect-change">--</div>
                        <div class="health-indicator" id="inflationexpect-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Economic Output & Growth -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Economic Output &amp; Growth</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Shows momentum in production and business activity.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Real GDP Growth Rate</div>
                        <div class="metric-value" id="gdp-value">Loading...</div>
                        <div class="metric-change" id="gdp-change">--</div>
                        <div class="health-indicator" id="gdp-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">PMI</div>
                        <div class="metric-value" id="pmi-value">Loading...</div>
                        <div class="metric-change" id="pmi-change">--</div>
                        <div class="health-indicator" id="pmi-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Industrial Production</div>
                        <div class="metric-value" id="industrialprod-value">Loading...</div>
                        <div class="metric-change" id="industrialprod-change">--</div>
                        <div class="health-indicator" id="industrialprod-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Labor Market Indicators -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Labor Market Indicators</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Measures employment conditions and wage pressures.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Unemployment Rate</div>
                        <div class="metric-value" id="unemployment-value">Loading...</div>
                        <div class="metric-change" id="unemployment-change">--</div>
                        <div class="health-indicator" id="unemployment-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Labor Participation Rate</div>
                        <div class="metric-value" id="labor-value">Loading...</div>
                        <div class="metric-change" id="labor-change">--</div>
                        <div class="health-indicator" id="labor-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Wage Growth</div>
                        <div class="metric-value" id="wagegrowth-value">Loading...</div>
                        <div class="metric-change" id="wagegrowth-change">--</div>
                        <div class="health-indicator" id="wagegrowth-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Wealth Inequality (Gini)</div>
                        <div class="metric-value" id="wealth-value">Loading...</div>
                        <div class="metric-change" id="wealth-change">--</div>
                        <div class="health-indicator" id="wealth-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Asset Prices -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Asset Prices</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Reflects investor sentiment and potential wealth effects.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">S&amp;P 500 Index</div>
                        <div class="metric-value" id="stockindex-value">Loading...</div>
                        <div class="metric-change" id="stockindex-change">--</div>
                        <div class="health-indicator" id="stockindex-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Real Estate Prices</div>
                        <div class="metric-value" id="realestate-value">Loading...</div>
                        <div class="metric-change" id="realestate-change">--</div>
                        <div class="health-indicator" id="realestate-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Credit Spread Risk</div>
                        <div class="metric-value" id="credit-value">Loading...</div>
                        <div class="metric-change" id="credit-change">--</div>
                        <div class="health-indicator" id="credit-health">--</div>
                    </div>
                </div>
            </div>

            <!-- External Balances & Currency -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">External Balances &amp; Currency</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Indicates international competitiveness and capital flows.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Current Account</div>
                        <div class="metric-value" id="currentaccount-value">Loading...</div>
                        <div class="metric-change" id="currentaccount-change">--</div>
                        <div class="health-indicator" id="currentaccount-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">FX Reserves</div>
                        <div class="metric-value" id="reserves-value">Loading...</div>
                        <div class="metric-change" id="reserves-change">--</div>
                        <div class="health-indicator" id="reserves-health">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Currency Strength</div>
                        <div class="metric-value" id="currency-value">Loading...</div>
                        <div class="metric-change" id="currency-change">--</div>
                        <div class="health-indicator" id="currency-health">--</div>
                    </div>
                </div>
            </div>

            <!-- Fiscal and Monetary Policy Actions -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 5px; color: #2c3e50;">Fiscal and Monetary Policy Actions</h3>
                <p style="color: #666; font-size: 0.85rem; margin-bottom: 10px;">Shows government budget stance and policy impacts on the economy.</p>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Fiscal Balance</div>
                        <div class="metric-value" id="fiscalbalance-value">Loading...</div>
                        <div class="metric-change" id="fiscalbalance-change">--</div>
                        <div class="health-indicator" id="fiscalbalance-health">--</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Climate Section -->
        <div class="content-section" id="climate">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Climate & Weather Dashboard</h2>
                    <p class="section-subtitle">Environmental data for your location (Costa Rica) and global climate metrics</p>
                </div>
                <div>
                    <a href="https://www.windy.com/-Rain-thunder-rain?rain,9.865,-84.413,9" target="_blank" 
                       style="color: #1976d2; text-decoration: none; font-size: 0.85rem;">
                       üìç View on Windy.com
                    </a>
                </div>
            </div>

            <!-- Embedded Windy Map for Rain & Thunder -->
            <div style="width: 100%; height: 450px; margin-bottom: 20px;">
                <iframe
                    width="100%"
                    height="100%"
                    src="https://embed.windy.com/embed2.html?lat=9.865&lon=-84.413&zoom=8&level=surface&overlay=rain&product=ecmwf&menu=&message=true&marker=&calendar=&pressure=true&type=map&location=coordinates&detail=&detailLat=9.865&detailLon=-84.413&metricWind=default&metricTemp=default&radarRange=-1"
                    frameborder="0">
                </iframe>
            </div>

            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50;">üå§Ô∏è Local Weather (San Jos√©, Costa Rica)</h3>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Current Temperature</div>
                        <div class="metric-value" id="temp-value">Loading...</div>
                        <div class="metric-change" id="temp-change">--</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Humidity</div>
                        <div class="metric-value" id="humidity-value">Loading...</div>
                        <div class="metric-change" id="humidity-change">--</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Wind Speed</div>
                        <div class="metric-value" id="wind-value">Loading...</div>
                        <div class="metric-change" id="wind-change">--</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Precipitation</div>
                        <div class="metric-value" id="precipitation-value">Loading...</div>
                        <div class="metric-change" id="precipitation-change">--</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Today's Rain</div>
                        <div class="metric-value" id="rain-forecast-value">Loading...</div>
                        <div class="metric-change" id="rain-forecast-change">--</div>
                    </div>
                </div>
                <div class="forecast-grid">
                    <div class="metric-card" id="forecast-today">Loading forecast...</div>
                    <div class="metric-card" id="forecast-tomorrow">Loading forecast...</div>
                    <div class="metric-card" id="forecast-10d">Loading forecast...</div>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50;">üåç Global Climate Indicators</h3>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Global Temperature Anomaly</div>
                        <div class="metric-value">+1.2¬∞C</div>
                        <div class="metric-change negative">+0.1¬∞C ‚Üó</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">CO2 Concentration</div>
                        <div class="metric-value">421 ppm</div>
                        <div class="metric-change negative">+2.4 ppm ‚Üó</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Arctic Sea Ice</div>
                        <div class="metric-value">4.2M km¬≤</div>
                        <div class="metric-change negative">-12% ‚Üò</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Renewable Energy %</div>
                        <div class="metric-value">12.6%</div>
                        <div class="metric-change positive">+1.2% ‚Üó</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- News Section -->
        <div class="content-section" id="news">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Latest News</h2>
                    <p class="section-subtitle">Top 5 headlines from World, US, and Costa Rica</p>
                        <div id="news-refresh-info" style="color: #666; font-size: 0.8rem;">Actualizado autom√°ticamente cada 10 minutos</div>
                </div>
                
            </div>

            <!-- World News -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    üåç World News
                </h3>
                <div class="news-grid" id="world-news-container">
                    <div class="news-card">
                        <div class="news-image"></div>
                        <div class="news-content">
                            <h3>Loading world news...</h3>
                            <p>Please wait while we fetch the latest global headlines.</p>
                            <div class="news-meta">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- US News -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    üá∫üá∏ United States News
                </h3>
                <div class="news-grid" id="us-news-container">
                    <div class="news-card">
                        <div class="news-image"></div>
                        <div class="news-content">
                            <h3>Loading US news...</h3>
                            <p>Please wait while we fetch the latest US headlines.</p>
                            <div class="news-meta">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Costa Rica News -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    üá®üá∑ Costa Rica News
                </h3>
                <div class="news-grid" id="costa-rica-news-container">
                    <div class="news-card">
                        <div class="news-image"></div>
                        <div class="news-content">
                            <h3>Loading Costa Rica news...</h3>
                            <p>Please wait while we fetch the latest local headlines.</p>
                            <div class="news-meta">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Digital Assets Section -->
        <div class="content-section" id="digital-assets">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Digital Assets</h2>
                    <p class="section-subtitle">Cryptocurrency performance and NFT portfolio</p>
                </div>
                <button onclick="loadCryptoData()" style="background: #1976d2; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">
                    üîÑ Refresh Prices
                </button>
            </div>

            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50;">üí∞ Cryptocurrency Portfolio</h3>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-title">Bitcoin (BTC)</div>
                        <div class="metric-value" id="btc-price">Loading...</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 0.8rem;">
                            <span id="btc-24h" class="metric-change">24h: --</span>
                            <span id="btc-30d" class="metric-change">30d: --</span>
                            <span id="btc-ytd" class="metric-change">YTD: --</span>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Ethereum (ETH)</div>
                        <div class="metric-value" id="eth-price">Loading...</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 0.8rem;">
                            <span id="eth-24h" class="metric-change">24h: --</span>
                            <span id="eth-30d" class="metric-change">30d: --</span>
                            <span id="eth-ytd" class="metric-change">YTD: --</span>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Cardano (ADA)</div>
                        <div class="metric-value" id="ada-price">Loading...</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 0.8rem;">
                            <span id="ada-24h" class="metric-change">24h: --</span>
                            <span id="ada-30d" class="metric-change">30d: --</span>
                            <span id="ada-ytd" class="metric-change">YTD: --</span>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">World Mobile Token (WMTx)</div>
                        <div class="metric-value" id="wmtx-price">Loading...</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 0.8rem;">
                            <span id="wmtx-24h" class="metric-change">24h: --</span>
                            <span id="wmtx-30d" class="metric-change">30d: --</span>
                            <span id="wmtx-ytd" class="metric-change">YTD: --</span>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Minutes Network Token (MNTx)</div>
                        <div class="metric-value" id="mntx-price">Loading...</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; font-size: 0.8rem;">
                            <span id="mntx-24h" class="metric-change">24h: --</span>
                            <span id="mntx-30d" class="metric-change">30d: --</span>
                            <span id="mntx-ytd" class="metric-change">YTD: --</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    üåç EarthNode NFTs (Cardano)
                    <span style="background: #1976d2; color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px;">Verified</span>
                </h3>
                <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">
                    Policy ID: b97859c71e4e73af3ae83c30a3172c434c43041f6ff19c297fb76094
                </p>

                <div class="dashboard-grid" style="margin-bottom: 20px;">
                    <div class="metric-card">
                        <div class="metric-title">Floor Price</div>
                        <div class="metric-value">‚Ç≥ 63k</div>
                        <div class="metric-change positive">+2.1% ‚Üó</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Best Offer</div>
                        <div class="metric-value">‚Ç≥ 40k</div>
                        <div class="metric-change neutral">-1.2% ‚Üí</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Volume</div>
                        <div class="metric-value">‚Ç≥ 22.5M</div>
                        <div class="metric-change positive">+15.3% ‚Üó</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">1M Average</div>
                        <div class="metric-value">‚Ç≥ 51.2k</div>
                        <div class="metric-change positive">+8.7% ‚Üó</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Listed</div>
                        <div class="metric-value">1.8%</div>
                        <div class="metric-change negative">-0.3% ‚Üò</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Total NFTs</div>
                        <div class="metric-value">1,000</div>
                        <div class="metric-change neutral">0% ‚Üí</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-title">Unique Wallets</div>
                        <div class="metric-value">51%</div>
                        <div class="metric-change positive">+1.8% ‚Üó</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Settings</h2>
                    <p class="section-subtitle">Customize your dashboard</p>
                </div>
            </div>

            <div style="max-width: 600px;">
                <div style="margin-bottom: 20px; padding: 15px; border: 1px solid #eee; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px;">Notifications</h4>
                    <label style="display: flex; align-items: center; margin-bottom: 10px;">
                        <input type="checkbox" style="margin-right: 10px;" checked>
                        Email notifications for price alerts
                    </label>
                    <label style="display: flex; align-items: center;">
                        <input type="checkbox" style="margin-right: 10px;" checked>
                        Push notifications for news updates
                    </label>
                </div>

                <div style="padding: 15px; border: 1px solid #eee; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px;">Data Sources</h4>
                    <p style="color: #666; font-size: 0.9rem;">
                        Economic data: Federal Reserve Economic Data (FRED)<br>
                        Climate data: NOAA, NASA<br>
                        NFT data: JPG.Store (Cardano)<br>
                        Crypto data: CoinGecko API
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function updateGreeting() {
            const greetingEl = document.getElementById('greeting');
            if (!greetingEl) return;
            const now = new Date();
            const hour = now.getHours();
            const day = now.getDay();
            const weekend = day === 0 || day === 6;
            let message;
            if (hour < 12) {
                message = `Good Morning Adrian, ${weekend ? 'enjoy your weekend' : 'have a nice day'}! ‚òÄÔ∏è`;
            } else if (hour < 18) {
                message = `Good Afternoon Adrian, ${weekend ? 'enjoy your weekend' : 'have a nice day'}! ‚õÖ`;
            } else {
                message = `Good Evening Adrian, ${weekend ? 'enjoy your weekend' : 'have a good night'}! üåô`;
            }
            greetingEl.textContent = message;
        }

        // Navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            const contentSections = document.querySelectorAll('.content-section');
            const themeToggle = document.getElementById('theme-toggle');

            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all nav items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Hide all content sections
                    contentSections.forEach(section => section.classList.remove('active'));
                    
                    // Show corresponding content section
                    const sectionId = this.getAttribute('data-section');
                    const targetSection = document.getElementById(sectionId);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });

            // Dark theme toggle
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-theme');
                const isDark = document.body.classList.contains('dark-theme');

                // Update icon
                themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';

                // Save preference
                localStorage.setItem('darkTheme', isDark);
            });

            // Load theme preference
            const savedTheme = localStorage.getItem('darkTheme');
            if (savedTheme === 'true') {
                document.body.classList.add('dark-theme');
                themeToggle.textContent = '‚òÄÔ∏è';
            }

            updateGreeting();
            setInterval(updateGreeting, 60 * 1000);

            // Initialize data loading
            loadEconomicData();
            loadWeatherData();
            loadNewsData();
            loadCryptoData();
            
            // Auto-refresh data every 5 minutes
            setInterval(() => {
                loadEconomicData();
                loadWeatherData();
                loadCryptoData();
            }, 5 * 60 * 1000);
            
            // Auto-refresh news every 10 minutes
            setInterval(loadNewsData, 10 * 60 * 1000);
        });

        // Economic data (keeping existing functionality)
        const FRED_API_KEY = '4aba315f03e5658a7ae6a8083473f44b';
        const CORS_PROXY = 'https://api.allorigins.win/raw?url=';
        const FRED_BASE_URL = 'https://api.stlouisfed.org/fred/series/observations';

        // Ray Dalio's Key Economic Indicators
        const indicators = {
            gdp: { series: 'GDPC1', title: 'Real GDP Growth', format: 'percent', unit: '%', thresholds: { good: 2, warning: 0 } },
            inflation: { series: 'CPIAUCSL', title: 'Inflation Rate', format: 'percent', unit: '%', transform: 'yoy_percent', thresholds: { good: 2, warning: 4 } },
            unemployment: { series: 'UNRATE', title: 'Unemployment Rate', format: 'percent', unit: '%', thresholds: { good: 5, warning: 8 } },
            debt: { series: 'GFDEBTN', title: 'Debt-to-GDP Ratio', format: 'percent', unit: '%', transform: 'debt_to_gdp', thresholds: { good: 60, warning: 90 } },
            mortgage: { series: 'MORTGAGE30US', title: '30-Year Mortgage Rate', format: 'percent', unit: '%', thresholds: { good: 4, warning: 7 } },
            labor: { series: 'CIVPART', title: 'Labor Participation', format: 'percent', unit: '%', thresholds: { good: 63, warning: 60 } },
            wealth: { series: 'GINIALLRH', title: 'Wealth Inequality (Gini)', format: 'decimal', unit: '', thresholds: { good: 0.4, warning: 0.5 } },
            credit: { series: 'DPSACBW027SBOG', title: 'Credit Spread', format: 'percent', unit: '%', thresholds: { good: 2, warning: 4 } },
            creditgrowth: { series: '', title: 'Private Credit Growth', format: 'percent', unit: '%', thresholds: { good: 5, warning: 2 } },
            debtservice: { series: '', title: 'Debt Service Ratio', format: 'percent', unit: '%', thresholds: { good: 10, warning: 20 } },
            shortrate: { series: '', title: 'Short-Term Rate', format: 'percent', unit: '%', thresholds: { good: 2, warning: 4 } },
            longrate: { series: '', title: 'Long-Term Yield', format: 'percent', unit: '%', thresholds: { good: 3, warning: 5 } },
            yieldcurve: { series: '', title: 'Yield Curve Spread', format: 'percent', unit: '%', thresholds: { good: 1, warning: 0 } },
            m2growth: { series: '', title: 'M2 Growth', format: 'percent', unit: '%', thresholds: { good: 5, warning: 2 } },
            balancesheet: { series: '', title: 'Central Bank Balance', format: 'currency', unit: '', thresholds: null },
            inflationexpect: { series: '', title: 'Inflation Expectations', format: 'percent', unit: '%', thresholds: { good: 2, warning: 3 } },
            pmi: { series: '', title: 'PMI', format: 'decimal', unit: '', thresholds: { good: 50, warning: 45 } },
            industrialprod: { series: '', title: 'Industrial Production', format: 'percent', unit: '%', thresholds: { good: 2, warning: 0 } },
            wagegrowth: { series: '', title: 'Wage Growth', format: 'percent', unit: '%', thresholds: { good: 3, warning: 1 } },
            stockindex: { series: '', title: 'S&P 500 Index', format: 'currency', unit: '', thresholds: null },
            realestate: { series: '', title: 'Real Estate Prices', format: 'percent', unit: '%', thresholds: { good: 5, warning: 0 } },
            currentaccount: { series: '', title: 'Current Account', format: 'percent', unit: '%', thresholds: { good: 0, warning: -3 } },
            reserves: { series: '', title: 'FX Reserves', format: 'currency', unit: '', thresholds: { good: 100, warning: 50 } },
            currency: { series: '', title: 'Currency Strength', format: 'decimal', unit: '', thresholds: { good: 100, warning: 90 } },
            fiscalbalance: { series: '', title: 'Fiscal Balance', format: 'percent', unit: '%', thresholds: { good: 0, warning: -3 } }
        };

        function formatValue(value, format) {
            switch (format) {
                case 'percent':
                    return `${value.toFixed(2)}%`;
                case 'decimal':
                    return value.toFixed(3);
                case 'currency':
                    return `${value.toLocaleString()}`;
                default:
                    return value.toFixed(2);
            }
        }

        function getHealthStatus(value, thresholds, reverse = false) {
            if (!thresholds) return 'neutral';
            
            if (reverse) {
                // For indicators where lower is better (like unemployment, inflation)
                if (value <= thresholds.good) return 'healthy';
                if (value <= thresholds.warning) return 'warning';
                return 'danger';
            } else {
                // For indicators where higher is better (like GDP growth, employment)
                if (value >= thresholds.good) return 'healthy';
                if (value >= thresholds.warning) return 'warning';
                return 'danger';
            }
        }

        function getHealthLabel(status) {
            switch (status) {
                case 'healthy': return 'üü¢ Healthy';
                case 'warning': return 'üü° Monitor';
                case 'danger': return 'üî¥ Risk';
                default: return '‚ö™ Unknown';
            }
        }

        function formatChange(change, trend) {
            const arrow = trend === 'positive' ? '‚Üó' : trend === 'negative' ? '‚Üò' : '‚Üí';
            const sign = change > 0 ? '+' : '';
            return `${sign}${change.toFixed(2)}% ${arrow}`;
        }

        async function fetchFredData(seriesId, limit = 10) {
            const cacheKey = `${seriesId}_${Date.now()}`;
            
            try {
                const url = `${CORS_PROXY}${encodeURIComponent(FRED_BASE_URL)}?series_id=${seriesId}&api_key=${FRED_API_KEY}&limit=${limit}&file_type=json&sort_order=desc`;
                
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data;
            } catch (error) {
                console.error(`Error fetching ${seriesId}:`, error);
                return null;
            }
        }

        function transformValue(value, transform) {
            if (!value || value === '.') return null;
            
            const numValue = parseFloat(value);
            if (isNaN(numValue)) return null;
            
            switch (transform) {
                case 'billions_to_trillions':
                    return numValue / 1000;
                case 'millions_to_trillions':
                    return numValue / 1000000;
                case 'yoy_percent':
                    return numValue * 0.1; // Simplified
                default:
                    return numValue;
            }
        }

        function calculateChange(current, previous) {
            if (!current || !previous || current === '.' || previous === '.') return 0;
            
            const curr = parseFloat(current);
            const prev = parseFloat(previous);
            
            if (isNaN(curr) || isNaN(prev) || prev === 0) return 0;
            
            return ((curr - prev) / prev) * 100;
        }

        function determineTrend(change) {
            if (Math.abs(change) < 0.01) return 'neutral';
            return change > 0 ? 'positive' : 'negative';
        }

        async function fetchEconomicData() {
            const results = {};
            
            try {
                // Fetch all indicators in parallel
                const promises = Object.entries(indicators).map(async ([key, indicator]) => {
                    const data = await fetchFredData(indicator.series, 5);
                    if (data && data.observations && data.observations.length >= 2) {
                        const observations = data.observations;
                        const latest = observations[0];
                        const previous = observations[1];
                        
                        let value = transformValue(latest.value, indicator.transform) || parseFloat(latest.value);
                        const change = calculateChange(latest.value, previous.value);
                        const trend = determineTrend(change);
                        
                        // Special handling for inflation
                        if (key === 'inflation') {
                            const yearAgoIndex = Math.min(observations.length - 1, 12);
                            if (observations[yearAgoIndex]) {
                                const yearAgoValue = parseFloat(observations[yearAgoIndex].value);
                                if (!isNaN(yearAgoValue) && yearAgoValue > 0) {
                                    value = ((parseFloat(latest.value) - yearAgoValue) / yearAgoValue) * 100;
                                }
                            }
                        }
                        
                        results[key] = {
                            value: value || 0,
                            change: change || 0,
                            trend: trend,
                            lastUpdated: latest.date
                        };
                    } else {
                        // Fallback data
                        const mockFallback = {
                            gdp: { value: 22.75, change: 1.25, trend: 'positive' },
                            inflation: { value: 3.36, change: 0.31, trend: 'negative' },
                            unemployment: { value: 3.90, change: 0.10, trend: 'negative' },
                            debt: { value: 34.00, change: 2.52, trend: 'negative' },
                            mortgage: { value: 7.03, change: 0.09, trend: 'negative' },
                            labor: { value: 62.7, change: 0.00, trend: 'neutral' }
                        };
                        results[key] = mockFallback[key];
                    }
                });
                
                await Promise.all(promises);
                return results;
                
            } catch (error) {
                console.error('Error fetching economic data:', error);
                // Return fallback data
                return {
                    gdp: { value: 22.75, change: 1.25, trend: 'positive' },
                    inflation: { value: 3.36, change: 0.31, trend: 'negative' },
                    unemployment: { value: 3.90, change: 0.10, trend: 'negative' },
                    debt: { value: 34.00, change: 2.52, trend: 'negative' },
                    mortgage: { value: 7.03, change: 0.09, trend: 'negative' },
                    labor: { value: 62.7, change: 0.00, trend: 'neutral' }
                };
            }
        }

        async function loadEconomicData() {
            try {
                // Using enhanced mock data based on current economic conditions
            const mockData = {
                gdp: { value: 2.1, change: 0.3, trend: 'positive' },
                inflation: { value: 3.2, change: -0.4, trend: 'positive' },
                unemployment: { value: 4.1, change: -0.2, trend: 'positive' },
                debt: { value: 123, change: 2.1, trend: 'negative' },
                mortgage: { value: 6.8, change: 0.1, trend: 'negative' },
                labor: { value: 62.5, change: -0.1, trend: 'negative' },
                wealth: { value: 0.48, change: 0.01, trend: 'negative' },
                credit: { value: 1.8, change: -0.2, trend: 'positive' },
                creditgrowth: { value: 4.2, change: 0.5, trend: 'positive' },
                debtservice: { value: 13.0, change: 0.2, trend: 'negative' },
                shortrate: { value: 5.1, change: 0.1, trend: 'positive' },
                longrate: { value: 4.2, change: -0.1, trend: 'negative' },
                yieldcurve: { value: -0.9, change: 0.1, trend: 'positive' },
                m2growth: { value: 3.2, change: -0.1, trend: 'negative' },
                balancesheet: { value: 8500, change: -50, trend: 'negative' },
                inflationexpect: { value: 2.4, change: 0.1, trend: 'positive' },
                pmi: { value: 51.4, change: 0.2, trend: 'positive' },
                industrialprod: { value: 1.7, change: -0.1, trend: 'negative' },
                wagegrowth: { value: 3.5, change: 0.1, trend: 'positive' },
                stockindex: { value: 4500, change: 15, trend: 'positive' },
                realestate: { value: 5.5, change: 0.3, trend: 'positive' },
                currentaccount: { value: -2.7, change: 0.1, trend: 'positive' },
                reserves: { value: 1300, change: -10, trend: 'negative' },
                currency: { value: 102, change: -0.5, trend: 'negative' },
                fiscalbalance: { value: -4.5, change: 0.2, trend: 'positive' }
            };

                Object.keys(mockData).forEach(key => {
                    const dataPoint = mockData[key];
                    const indicator = indicators[key];
                    const valueElement = document.getElementById(`${key}-value`);
                    const changeElement = document.getElementById(`${key}-change`);
                    const healthElement = document.getElementById(`${key}-health`);
                    
                    if (valueElement && changeElement && healthElement) {
                        // Update value
                        valueElement.textContent = formatValue(dataPoint.value, indicator.format);
                        valueElement.classList.remove('loading');
                        
                        // Update change
                        changeElement.textContent = formatChange(dataPoint.change, dataPoint.trend);
                        changeElement.className = `metric-change ${dataPoint.trend}`;
                        
                        // Update health status
                        const isReverse = ['inflation', 'unemployment', 'debt', 'mortgage', 'wealth', 'debtservice', 'shortrate', 'longrate', 'inflationexpect'].includes(key);
                        const healthStatus = getHealthStatus(dataPoint.value, indicator.thresholds, isReverse);
                        healthElement.textContent = getHealthLabel(healthStatus);
                        healthElement.className = `health-indicator ${healthStatus}`;
                    }
                });

                document.getElementById('lastUpdated').textContent = `Last updated: ${new Date().toLocaleString()}`;
            } catch (error) {
                console.error('Error loading economic data:', error);
                document.getElementById('lastUpdated').innerHTML = `
                    <span style="color: #f44336;">Error loading data</span>
                `;
            }
        }

        async function loadWeatherData() {
            try {
                // Using Open-Meteo API for your location in Costa Rica
                const lat = 9.9306338;
                const lon = -84.238416;
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,precipitation&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&forecast_days=10&timezone=auto`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.current) {
                    const current = data.current;
                    
                    // Update temperature
                    document.getElementById('temp-value').textContent = `${Math.round(current.temperature_2m)}¬∞C`;
                    document.getElementById('temp-value').classList.remove('loading');
                    document.getElementById('temp-change').textContent = `Feels like ${Math.round(current.temperature_2m + 2)}¬∞C`;
                    document.getElementById('temp-change').className = 'metric-change neutral';
                    
                    // Update humidity
                    document.getElementById('humidity-value').textContent = `${current.relative_humidity_2m}%`;
                    document.getElementById('humidity-value').classList.remove('loading');
                    document.getElementById('humidity-change').textContent = current.relative_humidity_2m > 70 ? 'High' : current.relative_humidity_2m > 40 ? 'Normal' : 'Low';
                    document.getElementById('humidity-change').className = `metric-change ${current.relative_humidity_2m > 70 ? 'warning' : 'neutral'}`;
                    
                    // Update wind
                    document.getElementById('wind-value').textContent = `${Math.round(current.wind_speed_10m)} km/h`;
                    document.getElementById('wind-value').classList.remove('loading');
                    document.getElementById('wind-change').textContent = current.wind_speed_10m > 20 ? 'Windy' : 'Calm';
                    document.getElementById('wind-change').className = `metric-change ${current.wind_speed_10m > 20 ? 'warning' : 'positive'}`;
                    
                    // Update precipitation
                    document.getElementById('precipitation-value').textContent = `${current.precipitation} mm`;
                    document.getElementById('precipitation-value').classList.remove('loading');
                    document.getElementById('precipitation-change').textContent = current.precipitation > 0 ? 'Raining' : 'Dry';
                    document.getElementById('precipitation-change').className = `metric-change ${current.precipitation > 0 ? 'warning' : 'positive'}`;

                    if (data.daily) {
                        const daily = data.daily;
                        if (daily.precipitation_sum) {
                            const rainToday = daily.precipitation_sum[0];
                            document.getElementById('rain-forecast-value').textContent = `${rainToday} mm`;
                            document.getElementById('rain-forecast-value').classList.remove('loading');
                            document.getElementById('rain-forecast-change').textContent = rainToday > 0 ? 'Rain expected' : 'No rain';
                            document.getElementById('rain-forecast-change').className = `metric-change ${rainToday > 0 ? 'warning' : 'positive'}`;
                        }
                        document.getElementById('forecast-today').textContent = `Today: ${Math.round(daily.temperature_2m_max[0])}¬∞/${Math.round(daily.temperature_2m_min[0])}¬∞`;
                        document.getElementById('forecast-tomorrow').textContent = `Tomorrow: ${Math.round(daily.temperature_2m_max[1])}¬∞/${Math.round(daily.temperature_2m_min[1])}¬∞`;
                        const max = Math.max(...daily.temperature_2m_max);
                        const min = Math.min(...daily.temperature_2m_min);
                        document.getElementById('forecast-10d').textContent = `10d High ${Math.round(max)}¬∞/Low ${Math.round(min)}¬∞`;
                    }
                }
            } catch (error) {
                console.error('Error loading weather data:', error);
                // Fallback to mock data
                document.getElementById('temp-value').textContent = '24¬∞C';
                document.getElementById('humidity-value').textContent = '75%';
                document.getElementById('wind-value').textContent = '12 km/h';
                document.getElementById('precipitation-value').textContent = '0 mm';
                document.getElementById('rain-forecast-value').textContent = '0 mm';
                document.getElementById('rain-forecast-change').textContent = 'No rain';
                document.getElementById('rain-forecast-change').className = 'metric-change positive';
                document.getElementById('forecast-today').textContent = 'Today: 26¬∞/18¬∞';
                document.getElementById('forecast-tomorrow').textContent = 'Tomorrow: 27¬∞/18¬∞';
                document.getElementById('forecast-10d').textContent = '10d High 29¬∞/Low 17¬∞';
            }
        }

        async function loadNewsData() {
            try {
                // Mock news data organized by region
                const newsData = {
                    world: [
                        { title: "Cumbre clim√°tica alcanza acuerdo hist√≥rico", summary: "L√≠deres mundiales se comprometen a nuevas metas de reducci√≥n de carbono para 2030.", time: "2 horas atr√°s", link: "https://www.un.org/es/climatechange" },
                        { title: "Relaciones comerciales internacionales muestran recuperaci√≥n", summary: "Indicadores econ√≥micos sugieren una mejora en las alianzas globales.", time: "4 horas atr√°s", link: "https://www.worldbank.org/en/topic/trade" },
                        { title: "Gigantes tecnol√≥gicos anuncian colaboraci√≥n en IA", summary: "Empresas l√≠deres forman alianza para el desarrollo responsable de la inteligencia artificial.", time: "6 horas atr√°s", link: "https://www.bbc.com/news/technology" },
                        { title: "Inversiones en energ√≠as renovables alcanzan cifras r√©cord", summary: "Proyectos solares y e√≥licos reciben financiamiento sin precedentes.", time: "8 horas atr√°s", link: "https://www.iea.org" },
                        { title: "Iniciativa global de salud lanza nuevo programa de vacunas", summary: "La OMS amplia la cobertura de inmunizaci√≥n en pa√≠ses en desarrollo.", time: "10 horas atr√°s", link: "https://www.who.int" }
                    ],
                    us: [
                        { title: "Federal Reserve mantiene tasas de interes", summary: "El banco central mantiene sin cambios las tasas en medio de la incertidumbre economica.", time: "1 hora atras", link: "https://www.cnbc.com/2024/05/10/fed-keeps-rates-steady.html" },
                        { title: "Ley de infraestructura impulsa la economia", summary: "Nuevos datos revelan creacion de empleo y modernizacion de obras.", time: "3 horas atras", link: "https://www.wsj.com/articles/infrastructure-bill-economic-impact-2024" },
                        { title: "Sector tecnologico lidera el rally bursatil", summary: "Los indices principales suben por fuertes reportes de ganancias.", time: "5 horas atras", link: "https://www.nasdaq.com/articles/tech-stocks-lead-market-rally" },
                        { title: "Objetivos de independencia energetica ganan apoyo", summary: "El Congreso avanza legislacion para impulsar la produccion domestica de energia.", time: "7 horas atras", link: "https://www.politico.com/news/2024/05/10/energy-independence-bill-00000000" },
                        { title: "Mercado de vivienda muestra signos de estabilizacion", summary: "Datos inmobiliarios indican moderacion en la volatilidad de precios.", time: "9 horas atras", link: "https://www.cnn.com/2024/05/10/housing-market-stabilization/index.html" }
                    ],
                    costaRica: [
                        { title: "Inversion extranjera directa alcanza maximo historico", summary: "El pais capta niveles record de capital, segun datos oficiales.", time: "1 hora atras", link: "https://www.nacion.com/economia/inversion-extranjera-directa-alcanza-maximo-historico" },
                        { title: "Costa Rica fortalece su matriz energetica renovable", summary: "Autoridades impulsan proyectos de energia limpia en todo el territorio.", time: "3 horas atras", link: "https://www.larepublica.net/noticia/costa-rica-fortalece-su-matriz-energetica-renovable-2024" },
                        { title: "Sector turismo se recupera con fuerza", summary: "La llegada de visitantes se acerca a niveles prepandemia.", time: "5 horas atras", link: "https://www.elfinancierocr.com/negocios/sector-turismo-se-recupera-con-fuerza-este-ano" },
                        { title: "Precios del cafe costarricense suben en mercados internacionales", summary: "Productores locales celebran el alza en las exportaciones.", time: "7 horas atras", link: "https://www.nacion.com/economia/agro/precios-del-cafe-costarricense-suben-en-mercados" },
                        { title: "Plan fiscal reactivara la economia en 2024", summary: "Analistas prev en impacto positivo sobre la inversion y el empleo.", time: "9 horas atras", link: "https://www.larepublica.net/noticia/plan-fiscal-reactivara-la-economia-en-2024" }
                    ]
                };

                // Update World News
                updateNewsSection('world-news-container', newsData.world);
                
                // Update US News
                updateNewsSection('us-news-container', newsData.us);
                
                // Update Costa Rica News
                updateNewsSection('costa-rica-news-container', newsData.costaRica);
                
            } catch (error) {
                console.error('Error loading news data:', error);
            }
        }

        function updateNewsSection(containerId, articles) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            articles.slice(0, 5).forEach(article => {
                const newsCard = document.createElement('div');
                newsCard.className = 'news-card';
                newsCard.innerHTML = `
                    <div class="news-content">
                        <h3><a href="${article.link}" target="_blank">${article.title}</a></h3>
                        <p>${article.summary}</p>
                        <div class="news-meta">${article.time}</div>
                    </div>
                `;
                container.appendChild(newsCard);
            });
        }

        async function loadCryptoData() {
            const coinMap = {
                btc: 'bitcoin',
                eth: 'ethereum',
                ada: 'cardano',
                wmtx: 'world-mobile-token',
                mntx: 'minutes-network'
            };

            try {
                const ids = Object.values(coinMap).join(',');
                const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${ids}&price_change_percentage=24h,30d,1y`;
                const response = await fetch(url);
                if (!response.ok) throw new Error('Network response was not ok');
                const coins = await response.json();

                const dataMap = {};
                coins.forEach(c => dataMap[c.id] = c);

                Object.entries(coinMap).forEach(([key, id]) => {
                    const coin = dataMap[id];
                    if (!coin) return;
                    const priceElement = document.getElementById(`${key}-price`);
                    if (priceElement) {
                        const price = coin.current_price;
                        if (key === 'wmtx' || key === 'mntx') {
                            priceElement.textContent = price.toFixed(4);
                        } else {
                            priceElement.textContent = price.toLocaleString();
                        }
                        priceElement.classList.remove('loading');
                    }

                    const changes = {
                        '24h': coin.price_change_percentage_24h_in_currency,
                        '30d': coin.price_change_percentage_30d_in_currency,
                        'ytd': coin.price_change_percentage_1y_in_currency
                    };

                    Object.keys(changes).forEach(period => {
                        const value = changes[period];
                        const changeElement = document.getElementById(`${key}-${period}`);
                        if (changeElement && typeof value === 'number') {
                            const trend = value > 0 ? 'positive' : value < 0 ? 'negative' : 'neutral';
                            changeElement.textContent = `${period}: ${formatChange(value, trend)}`;
                            changeElement.className = `metric-change ${trend}`;
                        }
                    });
                });
            } catch (error) {
                console.error('Error loading crypto data:', error);
            }
        }
    </script>
</body>
</html>

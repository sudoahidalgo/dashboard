<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-right: 12px;
        }

        .user-details h4 {
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .user-details p {
            font-size: 0.75rem;
            color: #666;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #666;
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .nav-item.active {
            background: #e3f2fd;
            color: #1976d2;
            border-left-color: #1976d2;
        }

        .nav-item-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-item-badge {
            background: #ff4757;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
            background: #f8f9fa;
        }

        .top-bar {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-bar {
            flex: 1;
            max-width: 400px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .top-bar-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .notification-btn, .settings-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #666;
        }

        /* Content Sections */
        .content-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .section-subtitle {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .metric-title {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .metric-change {
            display: inline-flex;
            align-items: center;
            font-size: 0.85rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }

        .metric-change.positive {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .metric-change.negative {
            background: #ffebee;
            color: #c62828;
        }

        .metric-change.neutral {
            background: #fff3e0;
            color: #ef6c00;
        }

        /* NFT Grid */
        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .nft-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .nft-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .nft-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
        }

        .nft-info {
            padding: 15px;
        }

        .nft-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .nft-price {
            color: #1976d2;
            font-weight: 600;
        }

        /* News Cards */
        .news-grid {
            display: grid;
            gap: 15px;
        }

        .news-card {
            display: flex;
            gap: 15px;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .news-card:hover {
            background: #f8f9fa;
        }

        .news-image {
            width: 80px;
            height: 80px;
            background: #ddd;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .news-content h3 {
            font-size: 1rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .news-content p {
            color: #666;
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 5px;
        }

        .news-meta {
            font-size: 0.75rem;
            color: #999;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            opacity: 0.6;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Dark Theme Styles */
        body.dark-theme {
            background: #121212;
            color: #e0e0e0;
        }

        body.dark-theme .sidebar {
            background: #1e1e1e;
            border-right: 1px solid #333;
        }

        body.dark-theme .sidebar-header {
            border-bottom: 1px solid #333;
        }

        body.dark-theme .user-info {
            border-bottom: 1px solid #333;
        }

        body.dark-theme .nav-item:hover {
            background: #2a2a2a;
            color: #e0e0e0;
        }

        body.dark-theme .nav-item.active {
            background: #1a237e;
            color: #e3f2fd;
        }

        body.dark-theme .main-content {
            background: #121212;
        }

        body.dark-theme .top-bar,
        body.dark-theme .content-section,
        body.dark-theme .metric-card,
        body.dark-theme .nft-card,
        body.dark-theme .news-card {
            background: #1e1e1e;
            border-color: #333;
        }

        body.dark-theme .news-card:hover {
            background: #2a2a2a;
        }

        body.dark-theme .search-input {
            background: #2a2a2a;
            border-color: #444;
            color: #e0e0e0;
        }

        body.dark-theme .notification-btn,
        body.dark-theme .settings-btn {
            background: #2a2a2a;
            color: #e0e0e0;
        }

        body.dark-theme .section-title {
            color: #e0e0e0;
        }

        body.dark-theme .metric-value {
            color: #e0e0e0;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">üåç Dashboard</div>
            <p style="color: #666; font-size: 0.8rem;">Comprehensive Analytics</p>
        </div>

        <div class="user-info">
            <div class="user-avatar">AH</div>
            <div class="user-details">
                <h4>Adrian Hidalgo</h4>
                <p>Premium User</p>
            </div>
        </div>

        <nav class="nav-menu">
            <a href="#" class="nav-item active" data-section="economy">
                <div class="nav-item-icon">üìä</div>
                Economy
            </a>
            <a href="#" class="nav-item" data-section="climate">
                <div class="nav-item-icon">üå°Ô∏è</div>
                Climate
            </a>
            <a href="#" class="nav-item" data-section="news">
                <div class="nav-item-icon">üì∞</div>
                News
            </a>
            <a href="#" class="nav-item" data-section="digital-assets">
                <div class="nav-item-icon">üíé</div>
                Digital Assets
                <span class="nav-item-badge">New</span>
            </a>
            <a href="#" class="nav-item" data-section="settings">
                <div class="nav-item-icon">‚öôÔ∏è</div>
                Settings
            </a>
            
            <div style="margin-top: auto; padding: 20px; border-top: 1px solid #eee;">
                <button id="theme-toggle" class="nav-item" style="width: 100%; border: none; background: none; text-align: left;">
                    <div class="nav-item-icon">üåô</div>
                    Dark Theme
                </button>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="Search data, news, assets...">
                <div class="search-icon">üîç</div>
            </div>
            <div class="top-bar-actions">
                <button class="notification-btn">üîî</button>
                <button class="settings-btn">‚öôÔ∏è</button>
                <div class="user-avatar" style="width: 32px; height: 32px;">AH</div>
            </div>
        </div>

        <!-- Economy Section -->
        <div class="content-section active" id="economy">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Economic Dashboard</h2>
                    <p class="section-subtitle">Real-time economic indicators and trends</p>
                </div>
                <div id="lastUpdated" style="color: #666; font-size: 0.8rem;">Loading...</div>
            </div>

            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-title">Real GDP (Inflation Adjusted)</div>
                    <div class="metric-value" id="gdp-value">Loading...</div>
                    <div class="metric-change" id="gdp-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Annual Inflation</div>
                    <div class="metric-value" id="inflation-value">Loading...</div>
                    <div class="metric-change" id="inflation-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Unemployment Rate</div>
                    <div class="metric-value" id="unemployment-value">Loading...</div>
                    <div class="metric-change" id="unemployment-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Federal Debt</div>
                    <div class="metric-value" id="debt-value">Loading...</div>
                    <div class="metric-change" id="debt-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">30-Year Mortgage Rate</div>
                    <div class="metric-value" id="mortgage-value">Loading...</div>
                    <div class="metric-change" id="mortgage-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Labor Participation Rate</div>
                    <div class="metric-value" id="labor-value">Loading...</div>
                    <div class="metric-change" id="labor-change">--</div>
                </div>
            </div>
        </div>

        <!-- Climate Section -->
        <div class="content-section" id="climate">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Climate Dashboard</h2>
                    <p class="section-subtitle">Environmental metrics and climate data</p>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-title">Global Temperature Anomaly</div>
                    <div class="metric-value">+1.2¬∞C</div>
                    <div class="metric-change positive">+0.1¬∞C ‚Üó</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">CO2 Concentration</div>
                    <div class="metric-value">421 ppm</div>
                    <div class="metric-change negative">+2.4 ppm ‚Üó</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Arctic Sea Ice</div>
                    <div class="metric-value">4.2M km¬≤</div>
                    <div class="metric-change negative">-12% ‚Üò</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Renewable Energy %</div>
                    <div class="metric-value">12.6%</div>
                    <div class="metric-change positive">+1.2% ‚Üó</div>
                </div>
            </div>
        </div>

        <!-- News Section -->
        <div class="content-section" id="news">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Latest News</h2>
                    <p class="section-subtitle">Stay updated with current events</p>
                </div>
            </div>

            <div class="news-grid" id="news-container">
                <div class="news-card">
                    <div class="news-image"></div>
                    <div class="news-content">
                        <h3>Loading news...</h3>
                        <p>Please wait while we fetch the latest headlines.</p>
                        <div class="news-meta">Loading...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Digital Assets Section -->
        <div class="content-section" id="digital-assets">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Digital Assets</h2>
                    <p class="section-subtitle">Cryptocurrency and NFT portfolio</p>
                </div>
            </div>

            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    üåç EarthNode NFTs (Cardano) 
                    <span style="background: #1976d2; color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px;">Verified</span>
                </h3>
                <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">
                    Policy ID: b97859c71e4e73af3ae83c30a3172c434c43041f6ff19c297fb76094
                </p>
                
                <div class="dashboard-grid" style="margin-bottom: 20px;">
                    <div class="metric-card">
                        <div class="metric-title">Floor Price</div>
                        <div class="metric-value">‚Ç≥ 63k</div>
                        <div class="metric-change positive">+2.1% ‚Üó</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Best Offer</div>
                        <div class="metric-value">‚Ç≥ 40k</div>
                        <div class="metric-change neutral">-1.2% ‚Üí</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Volume</div>
                        <div class="metric-value">‚Ç≥ 22.5M</div>
                        <div class="metric-change positive">+15.3% ‚Üó</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">1M Average</div>
                        <div class="metric-value">‚Ç≥ 51.2k</div>
                        <div class="metric-change positive">+8.7% ‚Üó</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Listed</div>
                        <div class="metric-value">1.8%</div>
                        <div class="metric-change negative">-0.3% ‚Üò</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Total NFTs</div>
                        <div class="metric-value">1,000</div>
                        <div class="metric-change neutral">0% ‚Üí</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-title">Unique Wallets</div>
                        <div class="metric-value">51%</div>
                        <div class="metric-change positive">+1.8% ‚Üó</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-title">Bitcoin (BTC)</div>
                    <div class="metric-value" id="btc-price">Loading...</div>
                    <div class="metric-change" id="btc-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Ethereum (ETH)</div>
                    <div class="metric-value" id="eth-price">Loading...</div>
                    <div class="metric-change" id="eth-change">--</div>
                </div>

                <div class="metric-card">
                    <div class="metric-title">Cardano (ADA)</div>
                    <div class="metric-value" id="ada-price">Loading...</div>
                    <div class="metric-change" id="ada-change">--</div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Settings</h2>
                    <p class="section-subtitle">Customize your dashboard</p>
                </div>
            </div>

            <div style="max-width: 600px;">
                <div style="margin-bottom: 20px; padding: 15px; border: 1px solid #eee; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px;">Notifications</h4>
                    <label style="display: flex; align-items: center; margin-bottom: 10px;">
                        <input type="checkbox" style="margin-right: 10px;" checked>
                        Email notifications for price alerts
                    </label>
                    <label style="display: flex; align-items: center;">
                        <input type="checkbox" style="margin-right: 10px;" checked>
                        Push notifications for news updates
                    </label>
                </div>

                <div style="padding: 15px; border: 1px solid #eee; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px;">Data Sources</h4>
                    <p style="color: #666; font-size: 0.9rem;">
                        Economic data: Federal Reserve Economic Data (FRED)<br>
                        Climate data: NOAA, NASA<br>
                        NFT data: JPG.Store (Cardano)<br>
                        Crypto data: CoinGecko API
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            const contentSections = document.querySelectorAll('.content-section');
            const themeToggle = document.getElementById('theme-toggle');

            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all nav items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Hide all content sections
                    contentSections.forEach(section => section.classList.remove('active'));
                    
                    // Show corresponding content section
                    const sectionId = this.getAttribute('data-section');
                    const targetSection = document.getElementById(sectionId);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });

            // Dark theme toggle
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-theme');
                const isDark = document.body.classList.contains('dark-theme');
                
                // Update icon and text
                const icon = this.querySelector('.nav-item-icon');
                icon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                this.childNodes[2].textContent = isDark ? ' Light Theme' : ' Dark Theme';
                
                // Save preference
                localStorage.setItem('darkTheme', isDark);
            });

            // Load theme preference
            const savedTheme = localStorage.getItem('darkTheme');
            if (savedTheme === 'true') {
                document.body.classList.add('dark-theme');
                const icon = themeToggle.querySelector('.nav-item-icon');
                icon.textContent = '‚òÄÔ∏è';
                themeToggle.childNodes[2].textContent = ' Light Theme';
            }

            // Initialize data loading
            loadEconomicData();
            loadNewsData();
            loadCryptoData();
        });

        // Economic data (keeping existing functionality)
        const FRED_API_KEY = '4aba315f03e5658a7ae6a8083473f44b';
        const CORS_PROXY = 'https://api.allorigins.win/raw?url=';
        const FRED_BASE_URL = 'https://api.stlouisfed.org/fred/series/observations';

        const indicators = {
            gdp: { series: 'GDPC1', title: 'Real GDP', format: 'trillion', unit: 'trillion', transform: 'billions_to_trillions' },
            inflation: { series: 'CPIAUCSL', title: 'CPI Inflation', format: 'percent', unit: '%', transform: 'yoy_percent' },
            unemployment: { series: 'UNRATE', title: 'Unemployment', format: 'percent', unit: '%' },
            debt: { series: 'GFDEBTN', title: 'Federal Debt', format: 'trillion', unit: 'trillion', transform: 'millions_to_trillions' },
            mortgage: { series: 'MORTGAGE30US', title: 'Mortgage Rate', format: 'percent', unit: '%' },
            labor: { series: 'CIVPART', title: 'Labor Participation', format: 'percent', unit: '%' }
        };

        function formatValue(value, format) {
            switch (format) {
                case 'trillion':
                    return `$${value.toFixed(2)}T`;
                case 'percent':
                    return `${value.toFixed(2)}%`;
                case 'currency':
                    return `$${value.toLocaleString()}`;
                default:
                    return value.toFixed(2);
            }
        }

        function formatChange(change, trend) {
            const arrow = trend === 'positive' ? '‚Üó' : trend === 'negative' ? '‚Üò' : '‚Üí';
            const sign = change > 0 ? '+' : '';
            return `${sign}${change.toFixed(2)}% ${arrow}`;
        }

        async function fetchFredData(seriesId, limit = 10) {
            const cacheKey = `${seriesId}_${Date.now()}`;
            
            try {
                const url = `${CORS_PROXY}${encodeURIComponent(FRED_BASE_URL)}?series_id=${seriesId}&api_key=${FRED_API_KEY}&limit=${limit}&file_type=json&sort_order=desc`;
                
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data;
            } catch (error) {
                console.error(`Error fetching ${seriesId}:`, error);
                return null;
            }
        }

        function transformValue(value, transform) {
            if (!value || value === '.') return null;
            
            const numValue = parseFloat(value);
            if (isNaN(numValue)) return null;
            
            switch (transform) {
                case 'billions_to_trillions':
                    return numValue / 1000;
                case 'millions_to_trillions':
                    return numValue / 1000000;
                case 'yoy_percent':
                    return numValue * 0.1; // Simplified
                default:
                    return numValue;
            }
        }

        function calculateChange(current, previous) {
            if (!current || !previous || current === '.' || previous === '.') return 0;
            
            const curr = parseFloat(current);
            const prev = parseFloat(previous);
            
            if (isNaN(curr) || isNaN(prev) || prev === 0) return 0;
            
            return ((curr - prev) / prev) * 100;
        }

        function determineTrend(change) {
            if (Math.abs(change) < 0.01) return 'neutral';
            return change > 0 ? 'positive' : 'negative';
        }

        async function fetchEconomicData() {
            const results = {};
            
            try {
                // Fetch all indicators in parallel
                const promises = Object.entries(indicators).map(async ([key, indicator]) => {
                    const data = await fetchFredData(indicator.series, 5);
                    if (data && data.observations && data.observations.length >= 2) {
                        const observations = data.observations;
                        const latest = observations[0];
                        const previous = observations[1];
                        
                        let value = transformValue(latest.value, indicator.transform) || parseFloat(latest.value);
                        const change = calculateChange(latest.value, previous.value);
                        const trend = determineTrend(change);
                        
                        // Special handling for inflation
                        if (key === 'inflation') {
                            const yearAgoIndex = Math.min(observations.length - 1, 12);
                            if (observations[yearAgoIndex]) {
                                const yearAgoValue = parseFloat(observations[yearAgoIndex].value);
                                if (!isNaN(yearAgoValue) && yearAgoValue > 0) {
                                    value = ((parseFloat(latest.value) - yearAgoValue) / yearAgoValue) * 100;
                                }
                            }
                        }
                        
                        results[key] = {
                            value: value || 0,
                            change: change || 0,
                            trend: trend,
                            lastUpdated: latest.date
                        };
                    } else {
                        // Fallback data
                        const mockFallback = {
                            gdp: { value: 22.75, change: 1.25, trend: 'positive' },
                            inflation: { value: 3.36, change: 0.31, trend: 'negative' },
                            unemployment: { value: 3.90, change: 0.10, trend: 'negative' },
                            debt: { value: 34.00, change: 2.52, trend: 'negative' },
                            mortgage: { value: 7.03, change: 0.09, trend: 'negative' },
                            labor: { value: 62.7, change: 0.00, trend: 'neutral' }
                        };
                        results[key] = mockFallback[key];
                    }
                });
                
                await Promise.all(promises);
                return results;
                
            } catch (error) {
                console.error('Error fetching economic data:', error);
                // Return fallback data
                return {
                    gdp: { value: 22.75, change: 1.25, trend: 'positive' },
                    inflation: { value: 3.36, change: 0.31, trend: 'negative' },
                    unemployment: { value: 3.90, change: 0.10, trend: 'negative' },
                    debt: { value: 34.00, change: 2.52, trend: 'negative' },
                    mortgage: { value: 7.03, change: 0.09, trend: 'negative' },
                    labor: { value: 62.7, change: 0.00, trend: 'neutral' }
                };
            }
        }

        async function loadEconomicData() {
            try {
                const data = await fetchEconomicData();

                Object.keys(data).forEach(key => {
                    const dataPoint = data[key];
                    const valueElement = document.getElementById(`${key}-value`);
                    const changeElement = document.getElementById(`${key}-change`);
                    
                    if (valueElement && changeElement) {
                        valueElement.textContent = formatValue(dataPoint.value, indicators[key].format);
                        valueElement.classList.remove('loading');
                        changeElement.textContent = formatChange(dataPoint.change, dataPoint.trend);
                        changeElement.className = `metric-change ${dataPoint.trend}`;
                    }
                });

                document.getElementById('lastUpdated').textContent = `Last updated: ${new Date().toLocaleString()}`;
            } catch (error) {
                console.error('Error loading economic data:', error);
                document.getElementById('lastUpdated').innerHTML = `
                    <span style="color: #f44336;">Error loading data</span><br>
                    <small>Using cached/fallback data</small>
                `;
            }
        }

        async function loadNewsData() {
            // Mock news data
            const mockNews = [
                {
                    title: "Federal Reserve Maintains Interest Rates",
                    summary: "The Federal Reserve decided to keep interest rates unchanged at current levels following their latest meeting.",
                    time: "2 hours ago"
                },
                {
                    title: "Climate Report Shows Record Temperatures",
                    summary: "New data indicates global temperatures reached unprecedented levels this year, highlighting urgent climate concerns.",
                    time: "4 hours ago"
                },
                {
                    title: "Cryptocurrency Market Shows Volatility",
                    summary: "Bitcoin and other major cryptocurrencies experienced significant price movements in recent trading sessions.",
                    time: "6 hours ago"
                }
            ];

            const newsContainer = document.getElementById('news-container');
            newsContainer.innerHTML = '';

            mockNews.forEach(article => {
                const newsCard = document.createElement('div');
                newsCard.className = 'news-card';
                newsCard.innerHTML = `
                    <div class="news-image"></div>
                    <div class="news-content">
                        <h3>${article.title}</h3>
                        <p>${article.summary}</p>
                        <div class="news-meta">${article.time}</div>
                    </div>
                `;
                newsContainer.appendChild(newsCard);
            });
        }

        async function loadCryptoData() {
            // Mock crypto data - can be replaced with real API calls
            const mockCrypto = {
                btc: { price: 43250, change: 2.4, trend: 'positive' },
                eth: { price: 2650, change: -1.2, trend: 'negative' },
                ada: { price: 0.48, change: 0.8, trend: 'positive' }
            };

            Object.keys(mockCrypto).forEach(crypto => {
                const data = mockCrypto[crypto];
                const priceElement = document.getElementById(`${crypto}-price`);
                const changeElement = document.getElementById(`${crypto}-change`);
                
                if (priceElement && changeElement) {
                    priceElement.textContent = `${data.price.toLocaleString()}`;
                    priceElement.classList.remove('loading');
                    changeElement.textContent = formatChange(data.change, data.trend);
                    changeElement.className = `metric-change ${data.trend}`;
                }
            });
        }
    </script>
</body>
</html>
